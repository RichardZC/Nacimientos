@model IEnumerable<BE.usuario>

<div class="row">
    <form id="formValidate" method="post" action='@Url.Action("Mantenter","Usuario")' >
        <div class="col s6">
            <div class="row">
                <input type="hidden" id="PersonaId" name="pPersonaId" value="0" />
                <div class="input-field col s12">
                    <input type="text" name="country" id="autocomplete" placeholder="Nombre y/o apellido" />
                </div>
            </div>
        </div>
        <div class="input-field col s6">
            <button onclick="crearUsuario()" class="btn waves-effect waves-light left" type="submit" name="action" id="btnCrearUsuario" disabled>
                Crear usuario
                <i class="mdi-action-done right"></i>
            </button>
        </div>
    </form>
</div>


<div id="mail-app" class="section">
    <div class="row">
        <div class="col s12">
            <nav class="red">
                <div class="nav-wrapper">
                    <div class="left col s8 m6 l5">
                        <ul>
                            <li>
                                <a class="email-menu"><i class="mdi-navigation-menu"></i></a>
                            </li>
                            <li>
                                <a class="email-type">GESTIÓN DE USUARIOS</a>
                            </li>

                        </ul>
                    </div>
                    <div class="col s4 m6 l7">
                        <ul class="right">
                            <li>
                                <a href="#!"><i class="mdi-content-archive"></i></a>
                            </li>
                            <li>
                                <a href="#!"><i class="mdi-action-delete"></i></a>
                            </li>

                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    
            <div class="col s12">

                <div id="email-list" class="col s12 m12 l12 card-panel z-depth-1">
                    <ul class="collection">
                        @foreach (var item in Model)
                        {
                            <li class="collection-item avatar email-unread"
                                ondblclick="MostrarEditar(@item.UsuarioId);">
                                <!--mostrar con doble clik-->

                                <span class="circle @if (@item.Activo) { <text>light-blue</text>} else { <text>red</text>}">@item.Nombre.Substring(0, 1)</span>

                                <span class="email-title">@item.Nombre</span>
                                <p class="truncate grey-text ultra-small">@item.persona.DNI - @item.persona.NombreCompleto</p>

                                <a class="secondary-content email-time">
                                    <span class="blue-text ultra-small">cel: @item.persona.Celular</span>
                                </a>

                            </li>
                        }

                    </ul>
                   
                </div>

               


          
        </div>

    </div>



</div>



@section scripts {


    <script src="~/js/jquery.autocomplete.min.js"></script>
    <script>


        $(document).ready(function () {

            $('#autocomplete').autocomplete({
                serviceUrl: '@Url.Action("listaPersonas", "Usuario")',
                minChars: 2,
                onSelect: function (suggestion) {
                    console.log('You selected: ' + suggestion.value + ', ' + suggestion.data);
                    $("#PersonaId").val(suggestion.data);
                    document.getElementById("btnCrearUsuario").disabled = true;
                  
                },
                showNoSuggestionNotice: true,
                noSuggestionNotice: 'Lo siento, no hay resultados',
            });
        });


        function MostrarEditar(id) {
            window.location = '@Url.Action("Mantener", "Usuario")' + '/' + id;
        }

        function crearUsuario() {
            //alert($("#PersonaId").val());
            var PersonaId = $("#PersonaId").val();


            window.location = '@Url.Action("Mantener", "Usuario")' + '?id=0&pPersonaId=' + PersonaId;
           
            
        }

    </script>


}



